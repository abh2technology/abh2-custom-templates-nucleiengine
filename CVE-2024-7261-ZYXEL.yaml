id: CVE-2024-7261-ZYXEL

info:
  name: Zyxel AP and Security Router OS Command Injection Vulnerability
  author: mstfknn
  severity: critical
  description: An OS command injection vulnerability has been detected in certain Zyxel access point (AP) and security router devices. This vulnerability could allow an unauthenticated attacker to execute remote code.
  reference:
    - https://www.zyxel.com/global/en/support/security-advisories/zyxel-security-advisory-for-os-command-injection-vulnerability-in-aps-and-security-router-devices-09-03-2024
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-7261
  tags: cve,cve2024,zyxel,rce,ap,router

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/weblogin.cgi"
      - "{{BaseURL}}/cgi-bin/index.cgi"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "Zyxel"
          - "NWA"
        condition: and
      - type: word
        words:
          - "Zyxel"
          - "WAC"
        condition: and
      - type: word
        words:
          - "Zyxel"
          - "WAX"
        condition: and
      - type: word
        words:
          - "Zyxel"
          - "USG LITE"
        condition: and

    extractors:
      - type: regex
        name: model
        group: 1
        regex:
          - "Model: (NWA[0-9]+|WAC[0-9]+|WAX[0-9]+|USG LITE [0-9]+AX)"
      - type: regex
        name: firmware
        group: 1
        regex:
          - "Firmware Version: ([0-9.]+)"
