id: polyfill-malware

info:
  name: Polyfill.io Malicious Payload Detection
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Detects the presence of malicious payload injected by polyfill.io, which redirects mobile users to a sports betting site using a fake Google analytics domain (www.googie-anaiytics.com). 
    The malware has specific protection against reverse engineering, and only activates on specific mobile devices at specific hours.
  reference:
    - https://sansec.io/research/polyfill-supply-chain-attack
    - https://x.com/triblondon/status/1761852117579427975

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        words:
          - "cdn.polyfill.io"