id: CVE-2024-7094

info:
  name: JS Help Desk <= 2.8.6 - PHP Code Injection and Remote Code Execution
  author: Morgan Robertson
  severity: critical
  description: |
    The JS Help Desk plugin for WordPress is vulnerable to PHP Code Injection leading to Remote Code Execution in all versions up to, and including, 2.8.6 via the 'storeTheme' function. This template tests for the vulnerability via the plugin's readme.txt file which includes a changelog for the currently installed version.

  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-7094
    - https://github.com/advisories/GHSA-344g-jvx4-773r
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/js-support-ticket/js-help-desk-the-ultimate-help-desk-support-plugin-286-unauthenticated-php-code-injection-to-remote-code-execution

  tags: wordpress,js-helpdesk,js-support-ticket,rce,cve-2024-7094,cve,cve2024

  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-7094
    cwe-id: CWE-94

  metadata:
    researcher: Connor Billings
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/js-support-ticket"
    fofa-query: body="/wp-content/plugins/js-support-ticket"


requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/js-support-ticket/readme.txt"
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "Stable tag:\\s*([0-9]+\\.[0-9]+\\.[0-9]+)"
      - type: regex
        part: body
        negative: true
        regex:
          - "Stable tag:\\s*2\\.8\\.7"
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - "Stable tag:\\s*([0-9]+\\.[0-9]+\\.[0-9]+)"