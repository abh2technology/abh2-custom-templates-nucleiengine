id: cve-2024-40627

info:
  name: FastAPI-OPA OPTIONS Request Bypass
  author: persona-twotwo, chae1xx1os, soonghee2, eeche,gy741
  severity: medium
  description: A vulnerability in the FastAPI OPA middleware allows unauthorized OPTIONS requests, potentially exposing the existence of system entities.
  impact: Find System entities, Information Disclosure, Security Policy Bypass, Potential Attack Vector
  remediation: update FastAPI
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-40627
    - https://github.com/advisories/GHSA-5f5c-8rvc-j8wf
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 5.8
    cve-id: CVE-2024-40627
  tags: cve, cve2024, Request Bypass, find system entities, Information Disclosure, Security Policy Bypass, Potential Attack Vector

requests:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
    
      - |
        OPTIONS / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: status
        status:
          - 401
          - 403
        part: body_1

      - type: status
        status:
          - 200
        part: body_2
