id: CVE-2024-6387

info:
  name: OpenSSH RegreSSHion
  author: affix
  severity: high
  description: |
    On July 1, 2024, a critical signal handler race condition vulnerability was disclosed in OpenSSH servers (sshd) on glibc-based Linux systems. This vulnerability, called RegreSSHion and tracked as CVE-2024-6387, can result in unauthenticated remote code execution (RCE) with root privileges. This vulnerability has been rated High severity (CVSS 8.1).
  tags: network,ssh,cve,regresshion

tcp:
  - inputs:

    host:
      - "{{Hostname}}"
    port: 22
    read-size: 1024

    matchers:
      - type: word
        part: data
        words:
          - SSH-2.0-OpenSSH_1
          - SSH-2.0-OpenSSH_2
          - SSH-2.0-OpenSSH_3
          - SSH-2.0-OpenSSH_4.0
          - SSH-2.0-OpenSSH_4.1
          - SSH-2.0-OpenSSH_4.2
          - SSH-2.0-OpenSSH_4.3
          - SSH-2.0-OpenSSH_4.4
          - SSH-2.0-OpenSSH_8.5
          - SSH-2.0-OpenSSH_8.6
          - SSH-2.0-OpenSSH_8.7
          - SSH-2.0-OpenSSH_8.8
          - SSH-2.0-OpenSSH_8.9
          - SSH-2.0-OpenSSH_9.0
          - SSH-2.0-OpenSSH_9.1
          - SSH-2.0-OpenSSH_9.2
          - SSH-2.0-OpenSSH_9.3
          - SSH-2.0-OpenSSH_9.4
          - SSH-2.0-OpenSSH_9.5
          - SSH-2.0-OpenSSH_9.6
          - SSH-2.0-OpenSSH_9.7
        condition: or

    extractors:
      - type: regex
        regex:
          - "SSH-[0-9].[0-9]-OpenSSH_[0.9].[0-9]"