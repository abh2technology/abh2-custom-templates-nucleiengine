id: springboot-heapdump-exposure

info:
  name: Exposed Springboot Heapdump Actuator
  author: s1d6p01nt7
  severity: critical
  description: |
    The "Detect Springboot Heapdump Actuator" module is designed to identify the presence of a heap dump actuator in a Spring Boot application. Heap dump actuators are endpoints in the application that can be used to retrieve a heap dump of the Java Virtual Machine (JVM) memory. This module specifically targets Spring Boot applications and aims to detect any misconfigurations or vulnerabilities related to the heap dump actuator. If detected, the application may be exposing sensitive information about the JVM memory, potentially leading to unauthorized access or information leakage, posing a security risk to the application and its users.

http:
  - raw:
      - |
        GET /heapdump HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /actuator/heapdump HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/v5/actuator/heapdump HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /heapdump/actuator HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /actuator/heapdump/api/v5 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "JAVA PROFILE"
          - "HPROF"
        part: body
      - type: status
        status:
          - 200
          - 206